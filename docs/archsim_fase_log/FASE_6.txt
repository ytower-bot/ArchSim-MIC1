FASE 6 - LINGUAGEM ASSEMBLY E TESTES
Data: 28/11/2025
Status: Completa

OBJETIVO
Implementar montador para linguagem assembly MIC-1 e suite de testes abrangente.

IMPLEMENTAÇÃO DO MONTADOR

Conjunto de Instruções (8 instruções):
- LODD addr - Load direto: AC <- Memory[addr]
- STOD addr - Store direto: Memory[addr] <- AC
- ADDD addr - Add direto: AC <- AC + Memory[addr]
- SUBD addr - Subtract direto: AC <- AC - Memory[addr]
- LOCO const - Load constante: AC <- const
- JUMP addr - Jump incondicional: PC <- addr
- JZER addr - Jump se zero: if (AC == 0) PC <- addr
- HALT - Para execução

Funcionalidades:
- Suporte a labels para endereçamento simbólico
- Suporte a comentários (linhas começando com ';')
- Parsing de operandos: decimal e hexadecimal (prefixo 0x)
- Assembly em dois passos: resolução de símbolos, geração de código
- Saída binária: formato de 16 bits (8 bits opcode + 8 bits operando)

API do Assembly:
- assemble(source, output, size) - Monta string para binário
- assemble_file(input, output) - Monta arquivo para arquivo

SEPARAÇÃO DE CACHE

Implementação:
- instruction_cache e data_cache separados na estrutura mic1_cpu
- Rastreamento independente de hit/miss para cada cache
- Previne conflitos de acesso instrução/dados
- Otimizado para busca sequencial de instruções

SUITE DE TESTES

Arquivos de teste:
- test_assembler.c - Testa funcionalidade do montador
  Teste 1: Programa simples sem labels
  Teste 2: Programa com labels e jumps
  Teste 3: Operações de montagem de arquivo
  Resultados: 3/3 passando

- test_cache_separation.c - Testa independência de caches
  Teste 1: Acesso cold/warm à cache de instruções
  Teste 2: Operação independente da cache de dados
  Teste 3: Precisão de rastreamento de estatísticas
  Resultados: 3/3 passando

- test_debug.c - Verificação de decodificação de microinstruções
  Teste 1: Decodifica campos de microinstrução de 32 bits
  Resultados: 1/1 passando

PROGRAMAS EXEMPLO

Exemplos assembly criados:
- examples/sum.asm - Soma dois números da memória
- examples/loop.asm - Loop com contador
- examples/maximum.asm - Encontra valor máximo em sequência

ARQUIVOS CRIADOS
- include/assembler.h (62 linhas)
- src/assembler.c (427 linhas)
- tests/test_assembler.c (94 linhas)
- tests/test_cache_separation.c (119 linhas)
- tests/test_debug.c (32 linhas)
- examples/sum.asm
- examples/loop.asm
- examples/maximum.asm

ARQUIVOS MODIFICADOS
- include/mic1.h (estrutura de cache atualizada)
- src/mic1.c (separação de cache)
- src/main.c (referências de cache corrigidas)

VALIDAÇÃO
Todos os testes passando: 7/7 total
- Testes montador: 3/3
- Testes cache: 3/3
- Testes debug: 1/1

Sistema de build:
- Makefile atualizado para compilação de testes
- make test executa todos os testes automaticamente
- Compilação limpa sem warnings

Docker:
- Dockerfile atualizado para usar make test
- Container compila e executa testes com sucesso

COMMIT
56bfc5f - feat: add assembly language support and test suite
